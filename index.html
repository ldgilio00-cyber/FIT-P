<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f6f7fb" />
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0b1220" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="./icon-192.png" />
<link rel="manifest" href="./manifest.webmanifest" />
  <link rel="stylesheet" href="./styles.css" />

  <title>Fit Planner</title>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">FP</div>
      <div class="brandText">
        <div class="title" id="appTitle">Fit Planner</div>
        <div class="subtitle" id="appSubtitle">Allenamento + Dieta ‚Ä¢ Offline</div>
      </div>
    </div>

    <nav class="tabs">
      <button class="tab active" data-view="home">Home</button>
      <button class="tab" data-view="workout">Allenamento</button>
      <button class="tab" data-view="diet">Dieta</button>
      <button class="tab" data-view="progress">Progressi</button>
      <button class="tab" data-view="settings">Impostazioni</button>
    </nav>
  </header>

  <main class="wrap">

    <!-- HOME -->
    <section class="view active" id="view-home">
      <div class="grid">
        <div class="card hero">
          <div class="heroTop">
            <div>
              <div class="heroTitle">Oggi</div>
              <div class="heroSub" id="homeTodayWorkout">‚Äî</div>
            </div>
            <div class="pill" id="homeKcal">‚Äî</div>
          </div>

          <div class="heroActions">
            <button class="btn primary big" id="btnStartSession">Inizia allenamento</button>
            <button class="btn big" id="btnTodayMeals">Pasti di oggi</button>
          </div>

          <div class="heroMini">
            <div class="mini">
              <div class="miniLabel">Sessioni salvate</div>
              <div class="miniValue" id="homeSessions">0</div>
            </div>
            <div class="mini">
              <div class="miniLabel">Scheda attiva</div>
              <div class="miniValue" id="homePlanName">‚Äî</div>
            </div>
          </div>
        </div>

        <div class="card">
          <h2>Azioni rapide</h2>
          <div class="actions">
            <button class="btn" data-jump="workout">Scheda</button>
            <button class="btn" data-jump="diet">Dieta</button>
            <button class="btn" id="btnGrocery">Lista spesa</button>
            <button class="btn" id="btnBackup">Backup</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ALLENAMENTO -->
    <section class="view hidden" id="view-workout">
      <div class="grid">
        <div class="card">
          <div class="cardHead">
            <h2>Allenamento</h2>
            <div class="row">
              <button class="btn primary" id="btnOpenPlans">Le mie schede</button>
            </div>
          </div>

          <div class="row">
            <label class="field" style="min-width:220px; flex:1">
              <span>Scheda attiva</span>
              <select id="activePlanSelect"></select>
            </label>

            <label class="field" style="min-width:240px; flex:1">
              <span>Giorno</span>
              <select id="daySelect"></select>
            </label>

            <button class="btn primary" id="btnStartDay">Avvia sessione</button>
          </div>

          <div id="dayPreview" class="list"></div>
        </div>

        <div class="card">
          <h2>Note PT</h2>
          <div class="tip"><b>Progressione</b>: se arrivi al top range con tecnica pulita ‚Üí aumenta leggermente il carico o le reps.</div>
          <div class="tip"><b>Timer</b>: dopo ‚ÄúSalva & Avvia timer‚Äù parte il recupero automatico del tuo esercizio.</div>
        </div>
      </div>
    </section>

    <!-- LE MIE SCHEDE -->
    <section class="view hidden" id="view-plans">
      <div class="card">
        <div class="cardHead">
          <h2>Le mie schede</h2>
          <div class="row">
            <button class="btn" id="btnPlansBack">‚Üê Indietro</button>
            <button class="btn primary" id="btnPlanNew">+ Nuova scheda</button>
          </div>
        </div>
        <div id="plansList" class="list"></div>
      </div>
    </section>

    <!-- EDITOR SCHEDA -->
    <section class="view hidden" id="view-planedit">
      <div class="grid">
        <div class="card">
          <div class="cardHead">
            <h2 id="planEditTitle">Editor Scheda</h2>
            <div class="row">
              <button class="btn" id="btnPlanEditBack">‚Üê Indietro</button>
              <button class="btn danger" id="btnPlanDelete">Elimina scheda</button>
            </div>
          </div>

          <div class="row">
            <label class="field" style="min-width:260px; flex:1">
              <span>Nome scheda</span>
              <input id="planName" type="text" placeholder="Es. Ipertrofia 4gg" />
            </label>
            <button class="btn primary" id="btnPlanSaveName">Salva nome</button>
          </div>

          <h2 style="margin-top:14px">Giorni</h2>
          <div class="row">
            <label class="field" style="min-width:260px; flex:1">
              <span>Nuovo giorno</span>
              <input id="newDayName" type="text" placeholder="Es. Luned√¨ ‚Äì Upper" />
            </label>

            <label class="field" style="min-width:170px">
              <span>Giorno settimana</span>
              <select id="newDayWeekday">
                <option value="1">Luned√¨</option>
                <option value="2">Marted√¨</option>
                <option value="3">Mercoled√¨</option>
                <option value="4">Gioved√¨</option>
                <option value="5">Venerd√¨</option>
                <option value="6">Sabato</option>
                <option value="0">Domenica</option>
              </select>
            </label>

            <button class="btn primary" id="btnAddDay">Aggiungi giorno</button>
            <button class="btn" id="btnDuplicateDay">Duplica giorno selezionato</button>
          </div>

          <div id="planDaysList" class="list"></div>
        </div>

        <div class="card">
          <h2>Esercizi</h2>

          <div class="row">
            <label class="field" style="min-width:260px; flex:1">
              <span>Giorno selezionato</span>
              <select id="planDaySelect"></select>
            </label>
          </div>

          <div class="row">
            <label class="field" style="min-width:240px; flex:1">
              <span>Esercizio</span>
              <input id="exNameIn" type="text" placeholder="Es. Panca piana bilanciere" />
            </label>

            <label class="field">
              <span>Serie</span>
              <input id="exSetsIn" type="number" min="1" step="1" value="3" />
            </label>

            <label class="field">
              <span>Reps min</span>
              <input id="exRepMinIn" type="number" min="1" step="1" value="8" />
            </label>

            <label class="field">
              <span>Reps max</span>
              <input id="exRepMaxIn" type="number" min="1" step="1" value="10" />
            </label>


            <label class="field">
              <span>Recupero</span>
              <input id="exRestIn" type="text" value="90" placeholder="Es. 90 oppure 2:00" />
            </label>

            <button class="btn primary" id="btnAddExercise">Aggiungi esercizio</button>
          </div>

          <div id="planExercisesList" class="list"></div>
        </div>
      </div>
    </section>

    <!-- DIETA -->
    <section class="view hidden" id="view-diet">
      <div class="grid">
        <div class="card">
          <div class="cardHead">
            <h2>Dieta</h2>
            <div class="row">
              <button class="btn primary" id="btnOpenDiets">Le mie diete</button>
              <button class="btn" id="btnGenerateGrocery">Lista spesa</button>
            </div>
          </div>

          <div class="row">
            <label class="field" style="min-width:220px; flex:1">
              <span>Dieta attiva</span>
              <select id="activeDietSelect"></select>
            </label>

            <label class="field">
              <span>Giorno</span>
              <select id="dietDaySelect"></select>
            </label>

            <label class="field">
              <span>Pasto</span>
              <select id="mealSelect">
                <option value="1">Pasto 1</option>
                <option value="2">Pasto 2</option>
                <option value="3">Pasto 3</option>
                <option value="4">Pasto 4</option>
                <option value="5">Pasto 5</option>
              </select>
            </label>
          </div>

          <div id="dietPreview" class="list"></div>
        </div>

        <div class="card">
          <h2>Target</h2>
          <div class="kpiRow">
            <div class="kpi"><div class="kpiLabel">Kcal</div><div class="kpiValue" id="kcalTarget">‚Äî</div></div>
            <div class="kpi"><div class="kpiLabel">Proteine</div><div class="kpiValue" id="pTarget">‚Äî</div></div>
            <div class="kpi"><div class="kpiLabel">Carbo</div><div class="kpiValue" id="cTarget">‚Äî</div></div>
            <div class="kpi"><div class="kpiLabel">Grassi</div><div class="kpiValue" id="fTarget">‚Äî</div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- LE MIE DIETE -->
    <section class="view hidden" id="view-diets">
      <div class="card">
        <div class="cardHead">
          <h2>Le mie diete</h2>
          <div class="row">
            <button class="btn" id="btnDietsBack">‚Üê Indietro</button>
            <button class="btn primary" id="btnDietNew">+ Nuova dieta</button>
          </div>
        </div>
        <div id="dietsList" class="list"></div>
      </div>
    </section>

    <!-- EDITOR DIETA -->
    <section class="view hidden" id="view-dietedit">
      <div class="grid">
        <div class="card">
          <div class="cardHead">
            <h2 id="dietEditTitle">Editor Dieta</h2>
            <div class="row">
              <button class="btn" id="btnDietEditBack">‚Üê Indietro</button>
              <button class="btn danger" id="btnDietDelete">Elimina dieta</button>
            </div>
          </div>

          <div class="row">
            <label class="field" style="min-width:260px; flex:1">
              <span>Nome dieta</span>
              <input id="dietName" type="text" placeholder="Es. Massa pulita" />
            </label>
            <button class="btn primary" id="btnDietSaveName">Salva nome</button>
          </div>

          <div class="row">
            <label class="field" style="min-width:220px">
              <span>Giorno</span>
              <select id="dietEditDaySelect"></select>
            </label>
            <label class="field" style="min-width:160px">
              <span>Pasto</span>
              <select id="dietEditMealSelect">
                <option value="1">Pasto 1</option>
                <option value="2">Pasto 2</option>
                <option value="3">Pasto 3</option>
                <option value="4">Pasto 4</option>
                <option value="5">Pasto 5</option>
              </select>
            </label>

            <button class="btn" id="btnCopyDayToAll">Copia giorno su tutti</button>
            <button class="btn" id="btnCopyMealToAllDays">Copia pasto su tutti</button>
          </div>
        </div>

        <div class="card">
          <h2>Alimenti del pasto</h2>

          <div class="row">
            <label class="field" style="min-width:240px; flex:1">
              <span>Alimento</span>
              <input id="foodNameIn" type="text" placeholder="Es. Riso basmati" />
            </label>
            <label class="field">
              <span>Quantit√†</span>
              <input id="foodQtyIn" type="number" min="0" step="1" value="100" />
            </label>
            <label class="field">
              <span>Unit√†</span>
              <select id="foodUnitIn">
                <option value="g">g</option>
                <option value="ml">ml</option>
                <option value="pz">pz</option>
              </select>
            </label>
            <button class="btn primary" id="btnAddFood">Aggiungi</button>
          </div>

          <div id="dietFoodsList" class="list"></div>
        </div>
      </div>
    </section>

    <!-- PROGRESSI -->
    <section class="view hidden" id="view-progress">
      <div class="grid">
        <div class="card">
          <h2>Storico sessioni</h2>
          <div class="tip">Tocca una sessione per vedere il dettaglio (e riprendere se √® aperta).</div>
          <div id="sessionHistory" class="list"></div>
        </div>

        <div class="card">
          <h2>PR (avanzati)</h2>
          <div class="tip">PR = migliori carichi (e stime tipo 1RM). Tocca un esercizio in sessione per confrontare ‚ÄúUltima/Best‚Äù.</div>
          <div id="prBox" class="list"></div>
        </div>

        <div class="card" style="grid-column: 1 / -1;">
          <h2>Progressione esercizio</h2>

          <div class="row">
            <label class="field" style="min-width:260px; flex:1">
              <span>Esercizio</span>
              <select id="exProgressSelect"></select>
            </label>
            <label class="field" style="min-width:180px">
              <span>Modalit√†</span>
              <select id="exProgressMode">
                <option value="best">Miglior kg (sessione)</option>
                <option value="avg">Media kg (sessione)</option>
                <option value="volume">Volume (kg * reps)</option>
              </select>
            </label>
          </div>

          <div class="tip" id="exProgressSummary" style="margin-top:10px">
            Seleziona un esercizio per vedere l‚Äôandamento.
          </div>

          <div class="item" style="margin-top:10px">
            <canvas id="exProgressChart" height="140" style="width:100%; display:block;"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- IMPOSTAZIONI -->
    <section class="view hidden" id="view-settings">
      <div class="grid">
        <div class="card">
          <h2>Profilo & target</h2>

          <div class="row">
            <label class="field"><span>Peso (kg)</span><input id="setWeight" type="number" step="0.1" /></label>
            <label class="field"><span>Pasti al giorno</span><input id="setMeals" type="number" min="3" max="6" /></label>
          </div>

          <div class="row">
            <label class="field"><span>Kcal</span><input id="setKcal" type="number" step="10" /></label>
            <label class="field"><span>Proteine (g)</span><input id="setP" type="number" step="1" /></label>
            <label class="field"><span>Carbo (g)</span><input id="setC" type="number" step="1" /></label>
            <label class="field"><span>Grassi (g)</span><input id="setF" type="number" step="1" /></label>
          </div>

          <div class="row">
            <button class="btn primary" id="btnSaveSettings">Salva</button>
          </div>
        </div>

        <div class="card">
          <h2>Backup</h2>
          <div class="row">
            <button class="btn" id="btnExport">Export JSON</button>
            <label class="btn file">Import JSON
              <input id="fileImport" type="file" accept="application/json" hidden />
            </label>
          </div>
        </div>
      </div>
    </section>

  
  </main>

  <!-- BOTTOM NAV (mobile) -->
  <nav class="bottomnav" aria-label="Navigazione">
    <button class="tab navbtn active" data-view="home" aria-label="Home">
      <span class="navIcon">üè†</span><span class="navLabel">Home</span>
    </button>
    <button class="tab navbtn" data-view="workout" aria-label="Allenamento">
      <span class="navIcon">üèãÔ∏è</span><span class="navLabel">Workout</span>
    </button>
    <button class="tab navbtn" data-view="diet" aria-label="Dieta">
      <span class="navIcon">ü•ó</span><span class="navLabel">Dieta</span>
    </button>
    <button class="tab navbtn" data-view="progress" aria-label="Progressi">
      <span class="navIcon">üìà</span><span class="navLabel">Progressi</span>
    </button>
    <button class="tab navbtn" data-view="settings" aria-label="Impostazioni">
      <span class="navIcon">‚öôÔ∏è</span><span class="navLabel">Impostazioni</span>
    </button>
  </nav>


  <!-- SESSIONE DEDICATA (1 SERIE ALLA VOLTA) -->
  <section class="session hidden" id="session">
    <div class="sessionTop">
      <button class="btn ghost" id="btnSessionExit">‚Üê Esci</button>
      <div class="sessionTitle">
        <div class="sessionDay" id="sessionDay">‚Äî</div>
        <div class="sessionDate" id="sessionDate">‚Äî</div>
      </div>
      <button class="btn danger" id="btnSessionFinish">Chiudi</button>
    </div>

    <div class="timerCard">
      <div class="timerLabel">RECUPERO</div>
      <div class="timerTime" id="timerTime">00:00</div>
      <div class="timerRow">
        <button class="btn" id="btnTimerStart">Start</button>
        <button class="btn" id="btnTimerPause">Pausa</button>
        <button class="btn" id="btnTimerSkip">Salta</button>
      </div>
      <div class="muted small" id="timerHint">Parte automaticamente dopo ‚ÄúSalva & Avvia timer‚Äù.</div>
    </div>

    <div class="sessionBody">
      <div class="sessionNav">
        <button class="btn" id="btnPrevEx">‚óÄ</button>
        <div class="exMeta">
          <div class="exName" id="exName">‚Äî</div>
          <div class="exTarget" id="exTarget">‚Äî</div>
        </div>
        <button class="btn" id="btnNextEx">‚ñ∂</button>
      </div>

      <div class="singleSet" id="singleSetBox"></div>
    </div>

    <div class="sessionBottom">
      <button class="btn primary big" id="btnSaveSet">Salva & Avvia timer</button>
      <button class="btn big" id="btnNextSet">Prossima serie</button>
      <button class="btn big" id="btnNextExercise">Prossimo esercizio</button>
    </div>
  </section>

  <!-- MODAL DETTAGLIO SESSIONE -->
  <section class="session hidden" id="sessionModal" aria-modal="true" role="dialog">
    <div class="sheet" role="document">
      <div class="sheetHandle" aria-hidden="true"></div>
      <div class="sessionTop">
        <button class="btn ghost" id="btnSessionModalClose">‚Üê Chiudi</button>
        <div class="sessionTitle">
          <div class="sessionDay" id="modalTitle">Dettaglio sessione</div>
          <div class="sessionDate" id="modalSub">‚Äî</div>
        </div>
        <button class="btn danger" id="btnSessionModalDelete">Elimina</button>
      </div>

      <div class="sessionBody" style="padding-bottom: 24px;">
        <div class="card" style="margin-top:14px;">
          <div class="row" style="justify-content:space-between;">
            <div class="pill" id="modalStatus">‚Äî</div>
            <button class="btn primary" id="btnSessionModalResume">Apri</button>
          </div>
          <div class="tip" id="modalSummary" style="margin-top:10px;">‚Äî</div>
        </div>

        <div class="card" style="margin-top:14px;">
          <h2>Dettaglio</h2>
          <div id="modalBody" class="list"></div>
        </div>
      </div>
    </div>
  </section>

  <div class="toast" id="toast"></div>
  <script src="./app.js"></script>
</body>
</html>
